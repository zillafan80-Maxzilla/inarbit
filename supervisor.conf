# iNarbit Supervisor 进程守护配置
# 位置: /etc/supervisor/conf.d/inarbit.conf
# 重新加载: supervisorctl reread && supervisorctl update

[program:inarbit-backend]
# 程序启动命令
command=/root/inarbit/dist/backend/inarbit-backend

# 工作目录
directory=/root/inarbit

# 运行用户
user=root

# 程序启动时是否自启
autostart=true

# 程序退出后是否自动重启
autorestart=true

# 自动重启的最大尝试次数，0为无限
startsecs=10

# 程序停止信号，可以是TERM, HUP, INT, QUIT, KILL, USR1, USR2
stopsignal=TERM

# 程序停止超时时间（秒）
stopwaitsecs=10

# 日志输出
# 标准输出日志
stdout_logfile=/root/inarbit/logs/inarbit.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=10

# 标准错误日志（重定向到标准输出）
redirect_stderr=true

# 环境变量
environment=PATH="/usr/local/go/bin:/usr/bin:/bin",HOME="/root"

# 优先级（数字越小，启动顺序越早）
priority=999

# 进程名称
process_name=%(program_name)s

# 数值表示进程组
numprocs=1

# 进程号
# %(process_num)d

# 标准输入文件
# stdin=/dev/null

# 进程退出代码
# exitcodes=0,2

# 是否在stderr中记录日志
# silent=false

# 是否使用umask
# umask=022

# 是否在启动时等待
# wait=false

# 是否禁用日志
# silent=false

# 是否使用eventlistener
# events=PROCESS_STATE

[group:inarbit]
# 组名
programs=inarbit-backend

# 优先级
priority=999

[unix_http_server]
file=/var/run/supervisor.sock

[supervisord]
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
nodaemon=false
childlogdir=/var/log/supervisor

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

# 监听端口（可选）
# [inet_http_server]
# port = 127.0.0.1:9001
